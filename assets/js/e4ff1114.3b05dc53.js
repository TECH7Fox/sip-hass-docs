"use strict";(self.webpackChunksip_hass_docs=self.webpackChunksip_hass_docs||[]).push([[2193],{3254:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"developers/add-on/ingress","title":"Ingress","description":"The Asterisk add-on uses the Home Assistant Ingress feature to provide a web interface for managing the Asterisk server and its settings.","source":"@site/docs/developers/add-on/ingress.md","sourceDirName":"developers/add-on","slug":"/developers/add-on/ingress","permalink":"/sip-hass-docs/docs/developers/add-on/ingress","draft":false,"unlisted":false,"editUrl":"https://github.com/TECH7Fox/sip-hass-docs/edit/main/docs/developers/add-on/ingress.md","tags":[{"inline":true,"label":"Add-on","permalink":"/sip-hass-docs/docs/tags/add-on"}],"version":"current","frontMatter":{"tags":["Add-on"]},"sidebar":"developersSidebar","previous":{"title":"Introduction","permalink":"/sip-hass-docs/docs/developers/add-on/introduction"},"next":{"title":"Integration","permalink":"/sip-hass-docs/docs/developers/integration"}}');var r=n(4848),o=n(8453);const i={tags:["Add-on"]},d="Ingress",a={},c=[{value:"Technical Setup",id:"technical-setup",level:2}];function l(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"ingress",children:"Ingress"})}),"\n",(0,r.jsx)(s.p,{children:"The Asterisk add-on uses the Home Assistant Ingress feature to provide a web interface for managing the Asterisk server and its settings.\nThis allows SIP Core to communicate with Asterisk without needing to port forward or setup SSL in Asterisk itself."}),"\n",(0,r.jsx)(s.h2,{id:"technical-setup",children:"Technical Setup"}),"\n",(0,r.jsxs)(s.p,{children:["On the add-on startup, it will grab it's own ingress entry\nand post it to the ",(0,r.jsx)(s.code,{children:"text.asterisk_addon_ingress_entry"})," entity\ntrough the supervisor API."]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["From: ",(0,r.jsx)(s.a,{href:"https://github.com/TECH7Fox/asterisk-hass-addons/blob/c7c5fb12bddc52156bde4254675dc41c21964c29/asterisk/rootfs/etc/cont-init.d/register-ingress-entry.sh#L12",children:"asterisk-hass-addons/asterisk/rootfs/etc/init.d/register_ingress.sh:12"})]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"INGRESS_ENTRY=$(api_call -X GET http://supervisor/addons/self/info | jq -r .data.ingress_entry)\nbashio::log.info ingress_entry: $INGRESS_ENTRY\napi_call -X POST http://supervisor/core/api/states/text.asterisk_addon_ingress_entry -d '{\"state\": \"'${INGRESS_ENTRY}'\"}'\n"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["This feature is implemented by ",(0,r.jsx)(s.strong,{children:"mrk-its"})," in ",(0,r.jsx)(s.a,{href:"https://github.com/TECH7Fox/asterisk-hass-addons/pull/371",children:"PR 371"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["This entity is detected and used by SIP Core to setup a ingress\nsession to connect to Asterisk.\nIf no entity is found, it will use the ",(0,r.jsx)(s.code,{children:" custom_wss_url"})," option\nfrom the ",(0,r.jsx)(s.code,{children:"sip-config.json"})," file."]}),"\n",(0,r.jsxs)(s.p,{children:["For more information on how SIP Core uses ingress, see the ",(0,r.jsx)(s.a,{href:"/sip-hass-docs/docs/developers/card/ingress",children:"SIP Core documentation"}),"."]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>d});var t=n(6540);const r={},o=t.createContext(r);function i(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(o.Provider,{value:s},e.children)}}}]);